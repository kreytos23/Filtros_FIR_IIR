close all
clear all

%Se lee el audio muestra
[x, FS]=audioread('archivoPrueba_CI.wav');

%Grafica de tiempo y frecuencia del audio original
figure(1)
subplot(211)
plot(x)
grid

%Tranformada de fourier del audio original
X=fftshift(fft(x));
F=-FS/2:FS/length(x):FS/2-FS/length(x);

figure(1)
subplot(212)
plot(F, abs(X));
grid

%Se deben eliminar las frecuencias de 400 y 4000

%-----------Filtro para 4000
%Coeficientes
h = [0.00483555685887667,-0.0161595464617610,-0.00513370346303886,-0.00186400203436437,-0.000562640312971448,0.000211715950566762,0.000710602967760883,0.000909811155808067,0.000796813057085664,0.000440572159569979,-1.42088492226910e-05,-0.000399910158864979,-0.000594073628448050,-0.000561091711071032,-0.000356836769778783,-0.000102886432807514,7.89962419639207e-05,0.000117278355533434,3.03322046587748e-05,-9.22457467370630e-05,-0.000129682242713635,4.84620610759702e-07,0.000293431790202570,0.000639269479662470,0.000860838010850811,0.000789008982576427,0.000348108062316292,-0.000387406649693246,-0.00119226081942906,-0.00175627273594288,-0.00179808823975423,-0.00118825362346790,-2.74026319886378e-05,0.00135386117146512,0.00248748650462893,0.00292450319436320,0.00240836830103419,0.000995184614345145,-0.000928460231834616,-0.00275115060227051,-0.00383230538607517,-0.00372854143478597,-0.00236802091861971,-0.000109546227174053,0.00235016799807551,0.00419646607826295,0.00477252869870316,0.00381597389150715,0.00156814941587505,-0.00128136899496378,-0.00381367077848234,-0.00518373086696364,-0.00491348160559355,-0.00306106462002400,-0.000211409173085807,0.00271224947418625,0.00475945775550223,0.00527093961466460,0.00410554992224268,0.00167782730989569,-0.00119229330657762,-0.00355877755891596,-0.00468812204242878,-0.00427318278233154,-0.00258047483141168,-0.000217781721046816,0.00194301075074387,0.00324920558131534,0.00337418393130861,0.00242664491987340,0.000916257405802450,-0.000521434351643371,-0.00139897116119554,-0.00151662083839996,-0.00103112614944145,-0.000373291055021883,-6.82676806723976e-06,-0.000178155051521523,-0.000797753182618797,-0.00145858577993102,-0.00163579133009458,-0.000929816291783912,0.000681533899930562,0.00275343951757407,0.00446983052875963,0.00494833392808402,0.00362043788188853,0.000547781377017419,-0.00347728546092442,-0.00711455052868615,-0.00891186224728148,-0.00785495514423329,-0.00383028513438347,0.00219421179247186,0.00837058538660559,0.0125321398573688,0.0129409061973876,0.00897348802829642,0.00147601370177862,-0.00736944678300058,-0.0146744423429225,-0.0177849693888516,-0.0152328366456281,-0.00735621275669189,0.00365577148884328,0.0143617729170239,0.0211476380636251,0.0214482842037843,0.0146975051428115,0.00265892610274631,-0.0110163460132032,-0.0219047259219189,-0.0262499078320460,-0.0222606606372190,-0.0108133243495568,0.00470200543341236,0.0193901455422597,0.0284114374677084,0.0285906015423286,0.0195340304956716,0.00385912571778272,-0.0135614512756210,-0.0271296466648398,-0.0323414801391819,-0.0272945998956742,-0.0133848828145250,0.00509173284225581,0.0222632536708673,0.0325913432728106,0.0326465683241829,0.0222994761525307,0.00476336347219068,-0.0144064222770276,-0.0290805777073597,0.965444150894220,-0.0290805777073597,-0.0144064222770276,0.00476336347219068,0.0222994761525307,0.0326465683241829,0.0325913432728106,0.0222632536708673,0.00509173284225581,-0.0133848828145250,-0.0272945998956742,-0.0323414801391819,-0.0271296466648398,-0.0135614512756210,0.00385912571778272,0.0195340304956716,0.0285906015423286,0.0284114374677084,0.0193901455422597,0.00470200543341236,-0.0108133243495568,-0.0222606606372190,-0.0262499078320460,-0.0219047259219189,-0.0110163460132032,0.00265892610274631,0.0146975051428115,0.0214482842037843,0.0211476380636251,0.0143617729170239,0.00365577148884328,-0.00735621275669189,-0.0152328366456281,-0.0177849693888516,-0.0146744423429225,-0.00736944678300058,0.00147601370177862,0.00897348802829642,0.0129409061973876,0.0125321398573688,0.00837058538660559,0.00219421179247186,-0.00383028513438347,-0.00785495514423329,-0.00891186224728148,-0.00711455052868615,-0.00347728546092442,0.000547781377017419,0.00362043788188853,0.00494833392808402,0.00446983052875963,0.00275343951757407,0.000681533899930562,-0.000929816291783912,-0.00163579133009458,-0.00145858577993102,-0.000797753182618797,-0.000178155051521523,-6.82676806723976e-06,-0.000373291055021883,-0.00103112614944145,-0.00151662083839996,-0.00139897116119554,-0.000521434351643371,0.000916257405802450,0.00242664491987340,0.00337418393130861,0.00324920558131534,0.00194301075074387,-0.000217781721046816,-0.00258047483141168,-0.00427318278233154,-0.00468812204242878,-0.00355877755891596,-0.00119229330657762,0.00167782730989569,0.00410554992224268,0.00527093961466460,0.00475945775550223,0.00271224947418625,-0.000211409173085807,-0.00306106462002400,-0.00491348160559355,-0.00518373086696364,-0.00381367077848234,-0.00128136899496378,0.00156814941587505,0.00381597389150715,0.00477252869870316,0.00419646607826295,0.00235016799807551,-0.000109546227174053,-0.00236802091861971,-0.00372854143478597,-0.00383230538607517,-0.00275115060227051,-0.000928460231834616,0.000995184614345145,0.00240836830103419,0.00292450319436320,0.00248748650462893,0.00135386117146512,-2.74026319886378e-05,-0.00118825362346790,-0.00179808823975423,-0.00175627273594288,-0.00119226081942906,-0.000387406649693246,0.000348108062316292,0.000789008982576427,0.000860838010850811,0.000639269479662470,0.000293431790202570,4.84620610759702e-07,-0.000129682242713635,-9.22457467370630e-05,3.03322046587748e-05,0.000117278355533434,7.89962419639207e-05,-0.000102886432807514,-0.000356836769778783,-0.000561091711071032,-0.000594073628448050,-0.000399910158864979,-1.42088492226910e-05,0.000440572159569979,0.000796813057085664,0.000909811155808067,0.000710602967760883,0.000211715950566762,-0.000562640312971448,-0.00186400203436437,-0.00513370346303886,-0.0161595464617610,0.00483555685887667];

%Se realiza la convolucion del filtro y la señal
y1 = conv(h,x);

%Graficas de la señal con el primer filtrado en 4000Hz
figure(2)
subplot(211)
plot(y1)
grid

Y1=fftshift(fft(y1));
F=-FS/2:FS/length(y1):FS/2-FS/length(y1);

figure(2)
subplot(212)
plot(F, abs(Y1));
grid

%------------Filtro para 400
h2 = [-0.0223023546591171,0.00497106647989366,0.00442215391492697,0.00391707841418140,0.00345218706091960,0.00302544312523288,0.00263355031423018,0.00227489928531694,0.00194628755645578,0.00164653405013942,0.00137266014757420,0.00112379764247939,0.000897293125009239,0.000692318481199845,0.000506558278499074,0.000339532922477687,0.000188856288939880,5.43570609212119e-05,-6.61787325580938e-05,-0.000172776966334251,-0.000267447465144278,-0.000350065851773250,-0.000422613655245545,-0.000484705342472169,-0.000538335964959284,-0.000582842855041322,-0.000620262651375895,-0.000649777283059849,-0.000673338547646026,-0.000689964378676511,-0.000701735458676937,-0.000707256636356654,-0.000708992962743320,-0.000705085570057177,-0.000698156301108386,-0.000686099908894059,-0.000671978270500366,-0.000652843415441031,-0.000632817648510203,-0.000607296508803287,-0.000582733188753355,-0.000553510052558043,-0.000514245762839158,-0.000505766559311453,-0.000442720743406401,-0.000413435698522890,-0.000386586046048882,-0.000350060723070627,-0.000302209593105995,-0.000257425081479141,-0.000216464269378181,-0.000180231741138410,-0.000141558790682139,-0.000100607682007895,-5.55300535577606e-05,-1.06141441340974e-05,3.36985106834567e-05,7.45852180187855e-05,0.000113938692849738,0.000150980670114383,0.000188382033325930,0.000225241283402303,0.000262922122752951,0.000299456444206480,0.000335280222269802,0.000368272322107093,0.000399239068599532,0.000426686660269051,0.000452133538409207,0.000474524055479989,0.000495448474117369,0.000513900726237304,0.000531153135808143,0.000545688892550080,0.000558708677854618,0.000568211747088235,0.000575528111875913,0.000578799585715700,0.000579535747524420,0.000575901322285999,0.000570205623299325,0.000560004629530895,0.000548808252313433,0.000532985512413894,0.000515384139626554,0.000498699601010517,0.000470007745754315,0.000451570058968818,0.000423202086961977,0.000390850510867606,0.000358814044360719,0.000326979167182911,0.000289811039156683,0.000249212704622571,0.000206913901283734,0.000165419167118814,0.000122703874020165,7.83714876244867e-05,3.17387738356330e-05,-1.53251829976898e-05,-6.21471362093971e-05,-0.000107653907615498,-0.000153048994693758,-0.000198279737230416,-0.000244011816250896,-0.000289234728235858,-0.000333713572766926,-0.000376350348671872,-0.000417406572657728,-0.000456402209559513,-0.000494069563988265,-0.000529754681843814,-0.000563765776801801,-0.000595081069836376,-0.000623596458115311,-0.000648379713813457,-0.000669925539264899,-0.000687438564666966,-0.000701916101674299,-0.000712545757892363,-0.000720080902923459,-0.000723596836618030,-0.000723907736721028,-0.000719509727612321,-0.000712052502584950,-0.000699315158190050,-0.000683805955322403,-0.000664386159285757,-0.000639190199159691,-0.000615167098918283,-0.000582464061988388,-0.000548874636937126,-0.000512771794124314,-0.000472167854258801,-0.000426909808169224,-0.000380310167017309,-0.000331064330928550,-0.000278787518754469,-0.000223044738121122,-0.000166153480199092,-0.000108219670122178,-4.93880174871732e-05,1.12426013867228e-05,7.28131699102873e-05,0.000135008727991115,0.000196492273258558,0.000257698776747977,0.000318361134868723,0.000378819987531310,0.000438040777108230,0.000495681588651030,0.000550753000989215,0.000603540684558778,0.000653503698907595,0.000701163840885652,0.000745749278556636,0.000787223388371227,0.000824790448291746,0.000858584214000921,0.000887811272800966,0.000913170341007281,0.000933804160820658,0.000950211904918534,0.000961482966348634,0.000967873560331453,0.000968344164165977,0.000963983025570600,0.000953335716620845,0.000938409025292850,0.000917443207125849,0.000891317136894301,0.000861489911641004,0.000823879748481536,0.000783693557304092,0.000737706891973287,0.000686280701606969,0.000630978507026875,0.000572337515422685,0.000508780908029707,0.000441499905380228,0.000371243369784991,0.000298491767051167,0.000222366228666616,0.000143605757473723,6.30897106168840e-05,-1.83199088853715e-05,-0.000100827811177546,-0.000184021074956851,-0.000267724827851921,-0.000350882228477900,-0.000433113730006558,-0.000514066005843420,-0.000593886243591121,-0.000671977582684313,-0.000747797190712169,-0.000820355971555007,-0.000889538029186006,-0.000954763688847226,-0.00101603053901653,-0.00107280840176861,-0.00112466138667200,-0.00117084254255080,-0.00121148151177793,-0.00124584432478346,-0.00127427139831352,-0.00129617866050437,-0.00131153211941581,-0.00131974634338072,-0.00132108144622828,-0.00131457522984925,-0.00130148195446240,-0.00128046423473951,-0.00125291806405414,-0.00121844565250906,-0.00117575992711884,-0.00112766595264628,-0.00107130460119830,-0.00100849099266020,-0.000939784318896460,-0.000864737659014069,-0.000783265749025332,-0.000696954496332278,-0.000605480700970249,-0.000508977145812738,-0.000407807880944207,-0.000303396537140038,-0.000195912246198140,-8.55944822640562e-05,2.71547322430762e-05,0.000141173407265437,0.000256174417030196,0.000371559475541892,0.000487173673763522,0.000602126636294439,0.000715679021462278,0.000826863196698848,0.000935415160838245,0.00104076356914003,0.00114253677671988,0.00123956432893933,0.00133145728007834,0.00141755967113286,0.00149753726635807,0.00157081669493000,0.00163704535159111,0.00169508033870071,0.00174497986750299,0.00178604048940037,0.00181826580839421,0.00184124556568722,0.00185479827265349,0.00185817442272421,0.00185191295552735,0.00183479159085309,0.00180804030688067,0.00177066664850306,0.00172296847413393,0.00166597165492566,0.00159788372619625,0.00152054873516483,0.00143367735352268,0.00133715690928551,0.00123190417128466,0.00111858084243210,0.000996712522110005,0.000867062250855844,0.000730434430800153,0.000587477981401285,0.000438382276532534,0.000284149960083793,0.000125861911555908,-3.58389075432068e-05,-0.000200661228424180,-0.000367560927577756,-0.000535595282502863,-0.000703760326306266,-0.000871342280512987,-0.00103749963707371,-0.00120136169723327,-0.00136181321803701,-0.00151796684231300,-0.00166892412521855,-0.00181417864137045,-0.00195256968257972,-0.00208300190156966,-0.00220468613926829,-0.00231691536491300,-0.00241883644336044,-0.00251015666624098,-0.00258963024008787,-0.00265666362107219,-0.00271067505687281,-0.00275108110529770,-0.00277747808122384,-0.00278959960809659,-0.00278639621529759,-0.00276842078060786,-0.00273455071869223,-0.00268539390078427,-0.00262088758330829,-0.00254012529459484,-0.00244448348679022,-0.00233304014109461,-0.00220613688769958,-0.00206454371872792,-0.00190845999687332,-0.00173807960782895,-0.00155457910956308,-0.00135828290518339,-0.00114968685600558,-0.000929558790882956,-0.000699256496143993,-0.000459563658362141,-0.000211267211899456,4.45159977355715e-05,0.000306296282885009,0.000573260363387377,0.000844209089793714,0.00111780077472690,0.00139245656675088,0.00166689408928406,0.00193975181695534,0.00220978441459351,0.00247542663245491,0.00273524753588457,0.00298736930166886,0.00323053292478145,0.00346339592356980,0.00368424794235046,0.00389145528699929,0.00408393986716297,0.00425990139710332,0.00441845643454738,0.00455810566342484,0.00467723339996085,0.00477475231172308,0.00484944087647922,0.00490014872435405,0.00492639318164875,0.00492632912857488,0.00489975546724088,0.00484535759379193,0.00476243335091490,0.00465110845592320,0.00450993376633482,0.00433895064966137,0.00413797722463837,0.00390636312099477,0.00364417488431812,0.00335169284769009,0.00302867382802884,0.00267546212743831,0.00229256335304214,0.00188038950254996,0.00143929761818827,0.000970170826173670,0.000474160598237235,-4.79285895841792e-05,-0.000595404885361661,-0.00116689457331612,-0.00176105128879883,-0.00237665774131938,-0.00301230539108914,-0.00366629589968784,-0.00433693601244731,-0.00502260635675005,-0.00572165468583946,-0.00643211548343528,-0.00715223795448362,-0.00787985877839716,-0.00861266427213366,-0.00934896579985142,-0.0100868390044431,-0.0108236785245085,-0.0115577313717246,-0.0122865322932234,-0.0130078725014638,-0.0137200663326959,-0.0144204695000937,-0.0151071558960048,-0.0157780371565481,-0.0164308030731460,-0.0170641070268022,-0.0176754051076451,-0.0182628962539030,-0.0188248900226859,-0.0193590590341690,-0.0198645500492535,-0.0203395277958200,-0.0207822038560772,-0.0211913746899294,-0.0215657126328478,-0.0219037395430942,-0.0222046960530317,-0.0224675183529018,-0.0226913048016986,-0.0228753216520325,-0.0230191789205360,-0.0231222653930455,-0.0231841040802994,0.976795381282513,-0.0231841040802994,-0.0231222653930455,-0.0230191789205360,-0.0228753216520325,-0.0226913048016986,-0.0224675183529018,-0.0222046960530317,-0.0219037395430942,-0.0215657126328478,-0.0211913746899294,-0.0207822038560772,-0.0203395277958200,-0.0198645500492535,-0.0193590590341690,-0.0188248900226859,-0.0182628962539030,-0.0176754051076451,-0.0170641070268022,-0.0164308030731460,-0.0157780371565481,-0.0151071558960048,-0.0144204695000937,-0.0137200663326959,-0.0130078725014638,-0.0122865322932234,-0.0115577313717246,-0.0108236785245085,-0.0100868390044431,-0.00934896579985142,-0.00861266427213366,-0.00787985877839716,-0.00715223795448362,-0.00643211548343528,-0.00572165468583946,-0.00502260635675005,-0.00433693601244731,-0.00366629589968784,-0.00301230539108914,-0.00237665774131938,-0.00176105128879883,-0.00116689457331612,-0.000595404885361661,-4.79285895841792e-05,0.000474160598237235,0.000970170826173670,0.00143929761818827,0.00188038950254996,0.00229256335304214,0.00267546212743831,0.00302867382802884,0.00335169284769009,0.00364417488431812,0.00390636312099477,0.00413797722463837,0.00433895064966137,0.00450993376633482,0.00465110845592320,0.00476243335091490,0.00484535759379193,0.00489975546724088,0.00492632912857488,0.00492639318164875,0.00490014872435405,0.00484944087647922,0.00477475231172308,0.00467723339996085,0.00455810566342484,0.00441845643454738,0.00425990139710332,0.00408393986716297,0.00389145528699929,0.00368424794235046,0.00346339592356980,0.00323053292478145,0.00298736930166886,0.00273524753588457,0.00247542663245491,0.00220978441459351,0.00193975181695534,0.00166689408928406,0.00139245656675088,0.00111780077472690,0.000844209089793714,0.000573260363387377,0.000306296282885009,4.45159977355715e-05,-0.000211267211899456,-0.000459563658362141,-0.000699256496143993,-0.000929558790882956,-0.00114968685600558,-0.00135828290518339,-0.00155457910956308,-0.00173807960782895,-0.00190845999687332,-0.00206454371872792,-0.00220613688769958,-0.00233304014109461,-0.00244448348679022,-0.00254012529459484,-0.00262088758330829,-0.00268539390078427,-0.00273455071869223,-0.00276842078060786,-0.00278639621529759,-0.00278959960809659,-0.00277747808122384,-0.00275108110529770,-0.00271067505687281,-0.00265666362107219,-0.00258963024008787,-0.00251015666624098,-0.00241883644336044,-0.00231691536491300,-0.00220468613926829,-0.00208300190156966,-0.00195256968257972,-0.00181417864137045,-0.00166892412521855,-0.00151796684231300,-0.00136181321803701,-0.00120136169723327,-0.00103749963707371,-0.000871342280512987,-0.000703760326306266,-0.000535595282502863,-0.000367560927577756,-0.000200661228424180,-3.58389075432068e-05,0.000125861911555908,0.000284149960083793,0.000438382276532534,0.000587477981401285,0.000730434430800153,0.000867062250855844,0.000996712522110005,0.00111858084243210,0.00123190417128466,0.00133715690928551,0.00143367735352268,0.00152054873516483,0.00159788372619625,0.00166597165492566,0.00172296847413393,0.00177066664850306,0.00180804030688067,0.00183479159085309,0.00185191295552735,0.00185817442272421,0.00185479827265349,0.00184124556568722,0.00181826580839421,0.00178604048940037,0.00174497986750299,0.00169508033870071,0.00163704535159111,0.00157081669493000,0.00149753726635807,0.00141755967113286,0.00133145728007834,0.00123956432893933,0.00114253677671988,0.00104076356914003,0.000935415160838245,0.000826863196698848,0.000715679021462278,0.000602126636294439,0.000487173673763522,0.000371559475541892,0.000256174417030196,0.000141173407265437,2.71547322430762e-05,-8.55944822640562e-05,-0.000195912246198140,-0.000303396537140038,-0.000407807880944207,-0.000508977145812738,-0.000605480700970249,-0.000696954496332278,-0.000783265749025332,-0.000864737659014069,-0.000939784318896460,-0.00100849099266020,-0.00107130460119830,-0.00112766595264628,-0.00117575992711884,-0.00121844565250906,-0.00125291806405414,-0.00128046423473951,-0.00130148195446240,-0.00131457522984925,-0.00132108144622828,-0.00131974634338072,-0.00131153211941581,-0.00129617866050437,-0.00127427139831352,-0.00124584432478346,-0.00121148151177793,-0.00117084254255080,-0.00112466138667200,-0.00107280840176861,-0.00101603053901653,-0.000954763688847226,-0.000889538029186006,-0.000820355971555007,-0.000747797190712169,-0.000671977582684313,-0.000593886243591121,-0.000514066005843420,-0.000433113730006558,-0.000350882228477900,-0.000267724827851921,-0.000184021074956851,-0.000100827811177546,-1.83199088853715e-05,6.30897106168840e-05,0.000143605757473723,0.000222366228666616,0.000298491767051167,0.000371243369784991,0.000441499905380228,0.000508780908029707,0.000572337515422685,0.000630978507026875,0.000686280701606969,0.000737706891973287,0.000783693557304092,0.000823879748481536,0.000861489911641004,0.000891317136894301,0.000917443207125849,0.000938409025292850,0.000953335716620845,0.000963983025570600,0.000968344164165977,0.000967873560331453,0.000961482966348634,0.000950211904918534,0.000933804160820658,0.000913170341007281,0.000887811272800966,0.000858584214000921,0.000824790448291746,0.000787223388371227,0.000745749278556636,0.000701163840885652,0.000653503698907595,0.000603540684558778,0.000550753000989215,0.000495681588651030,0.000438040777108230,0.000378819987531310,0.000318361134868723,0.000257698776747977,0.000196492273258558,0.000135008727991115,7.28131699102873e-05,1.12426013867228e-05,-4.93880174871732e-05,-0.000108219670122178,-0.000166153480199092,-0.000223044738121122,-0.000278787518754469,-0.000331064330928550,-0.000380310167017309,-0.000426909808169224,-0.000472167854258801,-0.000512771794124314,-0.000548874636937126,-0.000582464061988388,-0.000615167098918283,-0.000639190199159691,-0.000664386159285757,-0.000683805955322403,-0.000699315158190050,-0.000712052502584950,-0.000719509727612321,-0.000723907736721028,-0.000723596836618030,-0.000720080902923459,-0.000712545757892363,-0.000701916101674299,-0.000687438564666966,-0.000669925539264899,-0.000648379713813457,-0.000623596458115311,-0.000595081069836376,-0.000563765776801801,-0.000529754681843814,-0.000494069563988265,-0.000456402209559513,-0.000417406572657728,-0.000376350348671872,-0.000333713572766926,-0.000289234728235858,-0.000244011816250896,-0.000198279737230416,-0.000153048994693758,-0.000107653907615498,-6.21471362093971e-05,-1.53251829976898e-05,3.17387738356330e-05,7.83714876244867e-05,0.000122703874020165,0.000165419167118814,0.000206913901283734,0.000249212704622571,0.000289811039156683,0.000326979167182911,0.000358814044360719,0.000390850510867606,0.000423202086961977,0.000451570058968818,0.000470007745754315,0.000498699601010517,0.000515384139626554,0.000532985512413894,0.000548808252313433,0.000560004629530895,0.000570205623299325,0.000575901322285999,0.000579535747524420,0.000578799585715700,0.000575528111875913,0.000568211747088235,0.000558708677854618,0.000545688892550080,0.000531153135808143,0.000513900726237304,0.000495448474117369,0.000474524055479989,0.000452133538409207,0.000426686660269051,0.000399239068599532,0.000368272322107093,0.000335280222269802,0.000299456444206480,0.000262922122752951,0.000225241283402303,0.000188382033325930,0.000150980670114383,0.000113938692849738,7.45852180187855e-05,3.36985106834567e-05,-1.06141441340974e-05,-5.55300535577606e-05,-0.000100607682007895,-0.000141558790682139,-0.000180231741138410,-0.000216464269378181,-0.000257425081479141,-0.000302209593105995,-0.000350060723070627,-0.000386586046048882,-0.000413435698522890,-0.000442720743406401,-0.000505766559311453,-0.000514245762839158,-0.000553510052558043,-0.000582733188753355,-0.000607296508803287,-0.000632817648510203,-0.000652843415441031,-0.000671978270500366,-0.000686099908894059,-0.000698156301108386,-0.000705085570057177,-0.000708992962743320,-0.000707256636356654,-0.000701735458676937,-0.000689964378676511,-0.000673338547646026,-0.000649777283059849,-0.000620262651375895,-0.000582842855041322,-0.000538335964959284,-0.000484705342472169,-0.000422613655245545,-0.000350065851773250,-0.000267447465144278,-0.000172776966334251,-6.61787325580938e-05,5.43570609212119e-05,0.000188856288939880,0.000339532922477687,0.000506558278499074,0.000692318481199845,0.000897293125009239,0.00112379764247939,0.00137266014757420,0.00164653405013942,0.00194628755645578,0.00227489928531694,0.00263355031423018,0.00302544312523288,0.00345218706091960,0.00391707841418140,0.00442215391492697,0.00497106647989366,-0.0223023546591171];
%Segundo filtrado para frecuencia de 400Hz
y2 = conv(h2,y1);

figure(3)
subplot(211)
plot(y2)
grid

Y2=fftshift(fft(y2));
F=-FS/2:FS/length(y2):FS/2-FS/length(y2);

%Espectro final del audio post filtrado
figure(3)
subplot(212)
plot(F, abs(Y2));
grid

%Se manda a escribir el audio filtrado
audiowrite('MartinMorenoCesarSadrak_FiltradaFIR.wav',y2,FS);

